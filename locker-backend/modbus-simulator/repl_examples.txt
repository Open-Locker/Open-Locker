# PyModbus REPL Beispiele für Schließfach-Simulator
# ==================================================

# 1. Verbindung herstellen
# -----------------------
# Diese Befehle können Sie nutzen, um sich mit dem Modbus-Server zu verbinden

# Initialisierung der TCP-Client-Verbindung
client.connect

# 2. Abfragen der Schließfach-Status
# ----------------------------------
# Liest die Werte der Holding Register für Schließfächer 1-3

# Alle drei Schließfächer auf einmal abfragen
client.read_holding_registers address=0 count=3 slave=1

# Einzelnes Schließfach abfragen
client.read_holding_registers address=0 count=1 slave=1  # Schließfach 1
client.read_holding_registers address=1 count=1 slave=1  # Schließfach 2
client.read_holding_registers address=2 count=1 slave=1  # Schließfach 3

# 3. Schließfach öffnen
# --------------------
# Schreibt eine 1 in die entsprechende Coil um ein Schließfach zu öffnen

client.write_coil address=0 value=1 slave=1  # Schließfach 1 öffnen
client.write_coil address=1 value=1 slave=1  # Schließfach 2 öffnen
client.write_coil address=2 value=1 slave=1  # Schließfach 3 öffnen

# 4. Interaktives Testen
# ---------------------
# Schritte für einen vollständigen Test:

# a) Status aller Schließfächer prüfen (initial alle geschlossen)
client.read_holding_registers address=0 count=3 slave=1

# b) Schließfach 1 öffnen
client.write_coil address=0 value=1 slave=1

# c) Kurz warten (1-2 Sekunden)

# d) Status prüfen - Schließfach 1 sollte jetzt offen sein (Wert 1)
client.read_holding_registers address=0 count=3 slave=1

# 5. Verbindung beenden
# -------------------
client.close 